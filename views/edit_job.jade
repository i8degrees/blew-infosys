extends layout

mixin text_field(name, value)
  //- input(type=text name='property['+arguments[0]+']')

  +print_field(name, value)
  if value != null
    input(type="text" name=name value=value)

mixin print_field()
  if arguments != null
    if arguments[0] && arguments[1]
      p #{arguments[0]} #{arguments[1]}
    else if arguments[1]
      p #{arguments[1]}

//- Create an option and potentially set its selected state (if the form has
//- state) for a selection input type.
//-
//- param label     The text label to use
//- param form_var  The variable used to determine selected state
mixin select_option(label, form_var)
  option(value= label, selected= form_var === label ? true : false)= label

block content
  script.
    function go_back() {
      window.history.back();
    }

  a(href="" onclick="go_back()") Go Back

  h2 Job

  form(action=locals.loc.pathname, method='POST', novalidate)
    label(for='job_client') Client Contact
    input(type="text" id='job_client' name="client" required)
    br
    br
    label(for='job_number') Job Number
    input(type="text" id='job_number' name="jobnum" required)
    br
    br
    label(for='date') Due date
    input(type="text" id='date' name="due_date")
    br
    br
    label(for='addr') Address
    input(type="text" id='addr' name="address")
    br
    br
    label(for='job_status') Job Status:
    p #{locals.job.status}
    br
    input(type="radio" name="status" value="1")
    label(for='job_status_1') Fieldwork

    input(type="radio" name="status" value="2")
    label(for='job_status_2') Drafting

    input(type="radio" name="status" value="3")
    label(for='job_status_3') Review
    input(type="radio" name="status" value="4")
    label(for='job_status_4') Completed
    br
    br
    div(class='label')
      //- +check_err( locals.input_errs['job'].notes )
      label(for='job_notes') Notes:
      //- span(class='req') Required
    textarea(id='job_notes', name='notes', spellcheck='true', maxlength=4096)= job.JobNotes
    br

    +print_field("Need by date: ", job.JobDateNeeded)

    +print_field("Created: ", job.DateCreated)
    +print_field("Edited: ", job.DateEdited)
    p(class='small') id: #{job.PropertyKey}

    button(type='submit', name='action', value='update_job') Update Job

    hr

    //- TODO(jeff): Additional validations!
    if job.PropertyKey != null
      a(href='/jobs/destroy/' + job.PropertyKey) destroy
      | &#32;-&#32;
