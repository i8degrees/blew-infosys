extends layout

mixin print_field()
  if arguments != null
    if arguments[0] && arguments[1]
      p #{arguments[0]} #{arguments[1]}
    else if arguments[1]
      p #{arguments[1]}

block content
  script.
    function go_back() {
      window.history.back();
    }

  a(href="" onclick="go_back()") Go Back

  h2 Jobs

  if pr_rows.length > 0
    p Results: #{pr_rows.length}
    each property in pr_rows

      +print_field("PID: ", property.PropertyKey)

      +print_field("Job number: ", property.JobNum)
      +print_field("Contact: ", property.JobContact)
      +print_field("Requested by: ", property.JobRequestedBy)
      +print_field("Name: ", property.Property)
      +print_field("Notes: ", property.Notes)
      +print_field("Notes: ", property.JobNotes)

      - var status_str = '';
      if property.JobStatus == 1
        - status_str = "Ordered";
      if property.JobStatus == 2
        - status_str = "In the field";
      else if property.JobStatus == 3
        - status_str = "In drafting";
      else if property.JobStatus == 4
        - status_str = "Needs Review";
      else if property.JobStatus == 5
        - status_str = "In Revision";
      else if property.JobStatus == 6
        - status_str = "Completed";
      else
        //- NOTE(jeff): NULL values
        - status_str = "Not assigned";
      p Job Status:
        b #{status_str}

      +print_field("Due date: ", property.JobDateNeeded)
      //- +print_field("Assigned to: ", property.JobAssignedTo)

      //- +print_field("Assigned: ", property.User1, property.User2, property.User3,
      //- property.User4, property.User5, property.User6, property.User7, property.User8)
      +print_field("Created: ", property.DateCreated)
      +print_field("Edited: ", property.DateEdited)

      hr
      // TODO: Validate!
      a(href='/api/properties/' + property.PropertyKey) edit
      &#32;-&#32;
      a(href='/api/properties/destroy/' + property.PropertyKey) destroy

      hr
